# Quiz Server

Spring Boot приложение для управления викторинами с JWT аутентификацией и PostgreSQL базой данных.

## Требования

- Java 17+
- Docker и Docker Compose
- Gradle

## Быстрый старт

### 1. Запуск базы данных

```bash
docker-compose up -d postgres
```

### 2. Настройка переменных окружения

Скопируйте файл `env.example` в `.env` и настройте переменные:

```bash
cp .env.example .env
# Отредактируйте .env файл
```

### 3. Запуск приложения

#### Стандартный запуск (с переменными из .env):
```bash
./gradlew bootRun
```

#### Для разработки (с профилем dev):
```bash
./gradlew bootRun --args='--spring.profiles.active=dev'
```

## Конфигурация

### Основная конфигурация (`application.yml`)
Использует переменные окружения из файла `.env`:
- Порт сервера
- Настройки базы данных
- JWT конфигурация
- Настройки JPA и Flyway

### Профиль разработки (`application-dev.yml`)
Переопределяет настройки для локальной разработки:
- Порт: 8085
- Логирование: DEBUG уровень
- SQL запросы: отображаются
- Жестко заданные настройки БД

## Переменные окружения

| Переменная | Описание | По умолчанию |
|------------|----------|--------------|
| `SERVER_PORT` | Порт сервера | `8081` |
| `DB_URL` | URL базы данных | - |
| `DB_USERNAME` | Имя пользователя БД | - |
| `DB_PASSWORD` | Пароль БД | - |
| `JWT_SECRET_KEY` | Секретный ключ JWT | - |
| `JWT_ACCESS_EXPIRATION` | Время жизни access токена (мс) | `3600000` |
| `JWT_REFRESH_EXPIRATION` | Время жизни refresh токена (мс) | `604800000` |

## Запуск в IntelliJ IDEA

1. Откройте проект в IntelliJ IDEA
2. Убедитесь, что база данных запущена
3. Для стандартного запуска: просто запустите `QuizServerApplication`
4. Для профиля dev: добавьте VM options: `-Dspring.profiles.active=dev`

## API Endpoints

- **Аутентификация**: `/api/auth/**`
- **Пользователи**: `/api/users/**`
- **Вопросы**: `/api/questions/**`
- **Мониторинг**: `/actuator/**`

## Миграции базы данных

Приложение использует Flyway для управления схемой БД. Миграции автоматически применяются при запуске.

## Безопасность

- JWT токены для аутентификации
- Spring Security для авторизации
- Валидация входных данных
- Защита от CSRF атак
